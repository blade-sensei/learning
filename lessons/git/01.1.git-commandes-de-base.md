Lister les commandes avec leur description, c'est quelque chose que vous pouvez trouver sur internet si vous tapez git basic commands, voici une bonne documentation: https://duzun.me/tips/git

Ici, vous allons plut√¥t mettre en pratique les sc√©nario vu dans la s√©ance "git-introduction", et d'autres sc√©narios plus complexes, afin d'avoir des cas les plus proches de la r√©alit√©.

- [Utiliser git](#utiliser-git)
- [Commandes et cas d'utilisations](#commandes-et-cas-dutilisations)
	- [revenir en arri√®re apr√®s un commit](#revenir-en-arri√®re-apr√®s-un-commit)
	- [mettre en "pause" une feature et changer de branche](#mettre-en-pause-une-feature-et-changer-de-branche)
	- [travailler en √©quipe (remote)](#travailler-en-√©quipe-remote)
	- [Synchroniser votre branche avec la branche stable](#synchroniser-votre-branche-avec-la-branche-stable)
		- [Synchroniser le local vers le remote](#synchroniser-le-local-vers-le-remote)
		- [Synchroniser le remote vers le local](#synchroniser-le-remote-vers-le-local)
	- [r√©soudre les conflits](#r√©soudre-les-conflits)
		- [**Comment r√©soudre un conflit local ?**](#comment-r√©soudre-un-conflit-local-)
		- [**Comment r√©soudre un conflit qui arrive quand on cr√©e un "pull request"**](#comment-r√©soudre-un-conflit-qui-arrive-quand-on-cr√©e-un-pull-request)
	- [fusionner votre travail (mani√®re classique)](#fusionner-votre-travail-mani√®re-classique)
	- [fusionner pour avoir un historique plus lisible](#fusionner-pour-avoir-un-historique-plus-lisible)
	- [modifier le dernier commit](#modifier-le-dernier-commit)
	- [switch vers la derni√®re branche visit√©](#switch-vers-la-derni√®re-branche-visit√©)
	- [r√©cup√©rez 1 commit en particulier d'une branche Y](#r√©cup√©rez-1-commit-en-particulier-dune-branche-y)
- [VS code extension - Git grah](#vs-code-extension---git-grah)
- [R√©f√©rences](#r√©f√©rences)


## Utiliser git

Ouvrez votre `terminal`

Vous avez un dossier de projet ? alors d√©placez vous vers ce dossier,  si non cr√©e un dossier avec le nom "git-practice" (mkdir)
`git init`  :  pour rajouter notre outil git √† ce dossier et cr√©er un "repository" 

Je cr√©e le fichier afin de documenter mon projet, `touch documentation.md` 

Je veux voir l'√©tat de mon repository, pour voir la branche o√π je me trouve, et les fichiers qui sont en staging (ou le contraire) `git status`

J'√©cris la ligne suivante `hello git` dans le fichier  `documentation.md`: ` echo "hello git" > documentation.md`

Je v√©rifie mon travail, `git status`

Je sauvegarder mon travail avec  message pour expliquer ma modification du projet,
- `git add .`  ajout tous les fichiers modifi√©s dans le **staging**
- `git -m "message, ajout de fichier de documentation"
 
Je veux voir l'historique des commits, pour m'assurer que j'ai commit 
	`git log` ou `git log --pretty=oneliine` 

## Commandes et cas d'utilisations

### revenir en arri√®re apr√®s un commit

Vous voulez revenir en arri√®re apr√®s avoir fait un commit ? il y a 2 sc√©narios:

- si vous voulez effacer complement le dernier commit faites: `git reset --hard HEAD^1` , rappelez vois, HEAD veut dire "le dernier commit o√π je me trouve"
- vous voulez effacer les 2 dernier commit ? alors ``git reset --hard HEAD^2`

- Vous avez fait 1 ou plusieurs commits et vous voulez revenir en arri√®re MAIS tout en gardant les modifications que vous avez fait `git reset --soft HEAD^1` (remplac√© le 1 par le nombre de commits que vous voulez effacer √† partir du HEAD) , vos changements seront mis dans le "staging"

### mettre en "pause" une feature et changer de branche

Vous travaillez sur votre branche "feature1", et on vous demande de travailler sur un fix urgent, comme vous n'√©tiez entrain de faire des changements sur la branche feature1, vous voulez pas encore cr√©er un commit, car ce n'est pas termin√©.. 
mais voulez allez devoir changer (checkout) de branche "fix-urgent"... git va vous dire, `tu ne peux pas changer de branche si t'as des changement en cours, sans commit` ...

utilisez `git stash` vous garder temporairement vos changement (SANS COMMIT), vous pouvez changer de branche maintenant, 

une fois que vous revenez sur votre branche "feature1", vous pouvez reprendre votre **stash** , avec `git stash pop` 

Ou alors vous pouvez avoir la liste de plusieurs stash et r√©cup√©rer celui qu'il vous faut avec 
```
git stash list
git stash apply n
```
### travailler en √©quipe (remote)

ajouter un serveur "remote", vous pouvez avoir plusieurs serveurs o√π vous pouvez partager votre repository en ligne.

si vous avez fait un "git clone", pour cr√©er votre repository, en g√©n√©ral, vous avez d√©j√† un "remote" associ√©, vous pouvez faire `git remote -v` pour v√©rifier la liste des remotes, 

si vous avez aucun remote, alors ajoutez le avec la commande `git remote add <RemoteName> <url>` 

> En g√©n√©ral le remote name c'est **origin** , mais si vous avez d'autres remotes, utilisez le nom qui correspond

Pour envoyer copier votre branche dans ce repository remote, faites `git push <remoteName> <branch-du-remote>`  (en g√©n√©ral on choisi le m√™me nom que la branche LOCAL, mais ce n'est pas obligatoire)

Donc √† chaque fois que vous voulez envoyer vos changements "locaux" vers le remote, vous allez devoir faire cette commande, MAIS on peut ne pas s'emb√™ter √† √©crire √† chaque fois le nom du remote et le nom de nom de la branche, pour faire simplement `git push` , afin de faire √ßa vous devez dire √† git, `cette branche local est li√© √† cette branche remote` , tapez 
`git push --set-upstream <remote> <branch-remote>` maintenant avec un simple `git push` vous synchronisez le local - remote

üîë Il est important de comprendre que les synchronisation local <-> remote se font uniquement pour une BRANCHE donn√©e (sauf si on fait un git pull)

### Synchroniser votre branche avec la branche stable

#### Synchroniser le local vers le remote
Une fois que vous avez un lien avec un remote, pour envoyer ce que vous avez dans votre BRANCHE LOCAL vers le REMOTE, faites

- mettez vous dans la branche que vous voulez synchroniser `git checkout <feature1>
- ensuite envoyez vos modifications vers le remote de votre choix, vous devez aussi s√©lectionner un nom de BRANCHE REMOTE (en g√©n√©ral on choisi le m√™me nom que la branche LOCAL, mais ce n'est pas obligatoire)  `git push <RemoteName> <RemoteBranch>`

#### Synchroniser le remote vers le local
Imaginons que votre coll√®gue √† mis √† jour la branche stable "master" car il vient d'int√©grer une fonctionnalit√©.. 
vous avez besoin de son travail car il a cr√©e une fonction qui va vous √™tre utile. Pour r√©cup√©rer le travail d'une branche, iici dans notre cas la branche master, faites 
- `git checkout master`  et `git pull`  pour mettre √† jour votre branche master LOCAL, le pull va ramener les changements du `<remote>`et la branch "master (du remote)", vous auriez pu aussi faire `git pull <remote> master` , mais `git pull` suffit, car par d√©faut on sait qu'on ram√®ne nos changements depuis `origin`et le m√™me nom de branche.

- une fois votre branche local master √† jour, mettez √† jour votre branche de "feature" (par example), `git checkout feature1`  pour revenir √† votre branche de feature, `git merge master` pour fusionner.
- si tous se passe bien, votre branche "feature1" est √† jour avec les changements de votre coll√®gue.. si vous avez des conflits, regardez la section "comment r√©soudre des conflits"


### r√©soudre les conflits

tout d'abord, il faut comprendre ce que c'est un conflit et pourquoi cela arrive, 

-  cela arrive lors qu'on fusionne une branche A et une branche B
- si git d√©tecte dans la branche A on a modifi√© le fichierZ de la ligne 1 √† 5 (par example), ET que dans la branche B on a aussi une modification √† la ligne 1 √† 5, ALORS git vas vous avertir, que il ne fait pas qu'elle version garder, celle de la branche A ou la B ? c'est qu'on appelle un **conflit**, deux version qui se superposent. 
- Donc, git vous demandera de choisir, en tout cas de faire le n√©cessaire pour ne pas avoir les 2 modifications qui se chevauchent. 

Cette image montre √† quoi ressemble un conflit, git va vous rajouter les lignes 
`<<<< HEAD` et ` >>>> changement entrant`, cela est fait pour s√©parer les deux "versions"
![[img_merge-conflict.png]]
#### **Comment r√©soudre un conflit local ?**
Le mieux est d'utiliser une interface graphique, celle de votre √©diteur de texte, cette partie nous allons la voir avec une vid√©o.


#### **Comment r√©soudre un conflit qui arrive quand on cr√©e un "pull request"** 
_Pull request est une fonctionnalit√© dans les interfaces web des repository remote_ (github, gitlab, azure etc), cela sert √† demander la "fusion" d'une branche X qu'on choisi dans une autre branche "cible" (en g√©n√©ral master, dev, staging), les branches "stables" qu'on retrouve dans un projet.

Par fois il arrive d'avoir un conflit entre ces branches, comme le fusion est faite sur l'interface web, vous pouvez utiliser l'interface du repository remote si la fonctionnalit√© existe
MAIS en g√©n√©ral on va r√©soudre ce type de conflits en local PUIS pousser notre "r√©solution de conflit" sur la Pull request

- `git checkout master` et `git pull`  (pour mettre √† jour notre local master)
- `git checkout feature-1`
- `git merge master`
- r√©soudre les conflits en local
- `git add -A`
- `git commit -m "message pour d√©clarer la r√©solution de conflits"
- `git push` 


https://akshayranganath.github.io/Git-Pull-Handling-Merge-Conflict/
### fusionner votre travail (mani√®re classique)

c'est le moyen de plus "classique" et celui qu'on utilise le plus pour fusionner deux branches, 
en g√©n√©ral cela va cr√©er un "commit de merge", c'est juste un commit que git va cr√©er pour montrer que il y a eu une fusion, il ressemblera √† √ßa:

La fusion de la branche "feature (verte)" dans la branche "base/master" donne comme r√©sultat un "new merge commit".



![[02 Branch-1 kopiera.png]]
### fusionner pour avoir un historique plus lisible

Rebase est aussi un moyen de fusionner deux branches, mais il poss√®de des diff√©rences avec git merge:

- le rebase "cr√©e des nouveaux identifiants de commits"
- attention quand vous travaillez sur une m√™me branche qui est partag√© par d'autres d√©veloppeurs, cela peut avoir un incident pour les autres d√©veloppeurs
- cr√©e un historique "lin√©aire"
- imaginez que vous avez une branche "feature1", si vous faites un `git rebase master`, vous allez "REBATIR" votre branche par dessus la branche `master`comme vous "reb√¢tissez" la base de votre branche, vous all√© avoir vos commits qui suivent DIRECTEMENT depuis la branche "master"

- regardez l'image ci dessous
- initialement le d√©veloppeur √† fait un checkout √† partir du commit "Bleu fonc√©", entre temps la branche "master" √† avanc√©  et a eu 3 nouveau commits "bleu ciel"
- git rebase a permit de **rebatir la base** de branche VERTE, pour commence √† partir de la base du dernier commit bleu ciel
- la diff√©rence aussi avec merge, c'est qu'on va faire une fusion commit par commit, en gros c'est comme faire plusieurs fusions, selon le nombre de commit que vous avez dans votre branche "feature".. si y e a trop, √ßa peut √™tre long.
- souvenez vous de la phrase *rebatir la base* üîë

![test](https://res.cloudinary.com/practicaldev/image/fetch/s--TkS9hra2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://i.imgur.com/hlt8M5c.gif)


Une autre image qui met en √©vidence quelque chose d'important: la **r√©√©criture des commits**

![[Pasted image 20240606160856.png]]

- vous voulez les commits C5 et C6 de votre branche (dans le "Start case" √† gauche) ? 
- leur identifiants respectifs sont "09qr2" et "ol42g"
- mais que se passe t-il apr√®s le "rebase" ? 
- les identifiant on chang√© "a2b51" et "y73fo"..
- c'est les m√™mes commits mais avec des identifiants diff√©rents, donc ils sont consid√©r√©s comme des "nouveaux" commits
- c'est pour cela que vous pouvez lire des articles qui disent que "rebase" va r√©ecrire l'historique, il faut faire attention avec cette phrase, "rebase" ne change rien de la "base" de l'historique, est que les identifiants des commits C4 C3... C0 on chang√© ? NON, c'est uniquement les commits qu'on essai de "repositionner" qui ont chang√© d'identifiant.

- ce-ci dit, c'est important de savoir √ßa, pour d√©cider si vous utilis√© rebase, s'il risque de proser probl√®me

- l'avantage principal de rebase est que vous allez pouvoir maintenir un "historique" lin√©aire, pour √©viter un historique comme celui de gauche üëá

![[Pasted image 20240606164203.png]]


### modifier le dernier commit

vous avez cr√©e un commit "ajout de feature A", et vous vous vous apercevez que vous avez oubli√© une petit modification, vous all√© √©crire un autre commit avec un message "ajout de feature A - bis" ? √ßa serait dommage de polluer l'historique avec un commit comme √ßa

il suffit juste de modifier le dernier commit pour ajouter votre modification oubli√©, utilise `--amend`: 

`git add -A` 
`git commit --amend` 

vous remarquerez que l'√©diteur de texte "vim" s'ouvre pour vous donner la possibilit√© de modifier le message et le titre du commit. Faites `ESC + : + x` pour sauvegarder et sortir. Voil√† le dernier commit comporte votre nouvelle modification.

### switch vers la derni√®re branche visit√©

Vous √™tes dans la branche master, ensuite vous faites "checkout" vers la branche "feature1", vous voulez revenir √† la branche master, faites pas `git checkout master`
`git checkout -` c'est plus rapide.

### r√©cup√©rez 1 commit en particulier d'une branche Y

UN SEUL commit d'une autre branche vous int√©r√©sse ? et vous ne voulez pas faire "merge" car il va fusionner des commits que vous n'avez pas besoin.

utilisez `git cherry-pick <hash-commit>` dans la branche o√π vous voulez ramener le commit, dans l'image ci-dessous, `git checkout master` ensuite `git cherry-pick <identifiant-commit-e>`


![[t√©l√©chargement (7).jpeg]]

## VS code extension - Git grah
- permet d'avoir un visuel sur les branches
- r√©cup√©rer facilement les identifiants de commits
- basculer vers une branche...

√† vous de voir si cela vous est utile
## R√©f√©rences


- git rebase / remote scenario: https://stackoverflow.com/a/72384204
- image rebase: https://hakdogan26.medium.com/understanding-git-merge-vs-rebase-b1d6e4bccb1d
- rebase merge: https://unstop.com/blog/git-rebase-vs-merge
- rebase vs merge: https://blog.git-init.com/differences-between-git-merge-and-rebase-and-why-you-should-care/
- https://media.licdn.com/dms/image/D4D22AQEG0NbbCgkSPA/feedshare-shrink_2048_1536/0/1706467341815?e=2147483647&v=beta&t=0Ea3foJl50_UNiCGgfKJiIJY87cVCm4-qpHnCqmLY2U


